<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//TEST_AMDTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.example.server.model.dao.admin.AdminMapper">

    <select id="viewEmp" resultType="User">
        SELECT username, E.name as name, email, gender, position, working_status as workingStatus, img, role, qr_path as qrPath, dep_id as depId, D.name as department, location, created_at as createdAt
        FROM EMPLOYEE E INNER JOIN DEPARTMENT D
       ON E.dep_id = D.id;
    </select>

    <insert id="mkUsername"  parameterType="User" >
        INSERT INTO EMPLOYEE ( username, email, qr_path )
        values (#{username}, #{email}, #{qrPath});
    </insert>

    <insert id="insertEmp"  parameterType="User" >
        INSERT INTO EMPLOYEE (username, dep_id,  name, password, email, img, gender, position, role, qr_path )
        values (#{username}, #{depId}, #{name}, #{password}, #{email}, #{img}, #{gender}, #{position}, #{role}, #{qrPath});
    </insert>

    <update id="deleteEmp" parameterType="java.util.List">
        <foreach collection="user" item="item" index="index" separator=",">
            UPDATE EMPLOYEE
            SET working_status = '1'
            WHERE username = #{item};
        </foreach>
    </update>

    <update id="updateEmp" parameterType="User">
        UPDATE EMPLOYEE
        SET name = #{name}, gender = #{gender}, img = #{img}, dep_id = #{depId}, position = #{position}, role = #{role}, qr_path = #{qrPath}
        WHERE username = #{username};
    </update>

    <select id="selectUsername" resultType="String">
        select username from EMPLOYEE;
    </select>
</mapper>